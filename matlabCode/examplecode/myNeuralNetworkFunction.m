function [Y,Xf,Af] = myNeuralNetworkFunction(X,~,~)
%MYNEURALNETWORKFUNCTION neural network simulation function.
%
% Auto-generated by MATLAB, 25-Jun-2020 23:35:09.
%
% [Y] = myNeuralNetworkFunction(X,~,~) takes these arguments:
%
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = Qx44 matrix, input #1 at timestep ts.
%
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = Qx1 matrix, output #1 at timestep ts.
%
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.0245315259984156;-0.0234502363162788;-0.0166248840195435;-0.0148426316485798;-0.0172191338420933;-0.018258285272087;-0.0164604424247185;-0.0106155494106062;-0.0371296263253616;-0.0508256407032072;-0.022063315492492;-0.0230277933539337;-0.0338320942822949;-0.0444777598270451;-0.0454837731969969;-0.0471457286764177;-0.0420898147461268;-0.0315564488608049;-0.013794501686095;0.000840997165281271;5.3676658201246e-05;0.00734016978338925;0.0178795916508202;-0.0860318697361073;-0.0531626083954978;0.0189258538385851;0.019612144557197;0.0133373020376523;0.00679050122821812;0.00663145820559864;0.00395381787186359;-0.0280837020134901;-0.0278127992899379;-0.00940461805816828;-0.014042018340094;-0.00886040928844119;-0.00407207240775272;-0.0129660857247899;-0.021946418712409;-0.0262522442157985;-0.0309357219730412;-0.0470178844056548;-0.0706779162130934;-0.0839944169922214];
x1_step1.gain = [38.2582489655645;14.6510184989216;30.2290706731253;25.2829650469139;19.9187934356104;17.1530306872585;20.014877299388;25.8348246183058;25.5240133225751;28.5646400545791;48.1793746629397;19.4703941916714;14.4185512971969;12.0281644569122;9.42678662472084;9.75117592879615;12.4447101300575;12.798215835433;12.2834647058851;11.178068339672;8.53160645371861;6.87736706284242;9.87485429445027;6.53923109107616;7.45520592088727;11.6177029276615;13.3689902257202;15.4573756847106;17.5810675862337;20.6353540858162;22.0839409778856;19.0883876421097;21.4378071496221;22.119896284599;24.6195763343814;25.4019496057866;23.91679635864;26.1233630981877;27.6239400693776;31.43234786878;40.2579574206462;46.4038406905539;35.677978678111;31.918213783957];
x1_step1.ymin = -1;

% Layer 1
b1 = [1.429202946237954075;1.1227384439491572277;0.82157108387702970642;0.44565675239479274339;-0.053465135586587317351;0.088546130972313785712;-0.4640428720175120425;-0.85413038646835293122;-1.1945901821076829741;-1.4097735864096176961];
IW1_1 = [-0.24432807490018579322 -0.26656934310896296392 0.34053535502009246727 0.10041605302228970298 0.19783092940705582219 -0.29752345722016920737 0.10808298863273516077 -0.096705751213856688819 0.020597564221680041141 -0.39142763678403480476 0.20551926961953367878 0.013233337378725177486 0.25933313484990333508 0.12457361365543119514 -0.21819338571067567467 -0.17886314775229578133 0.35974252316990806833 -0.15804432608126509074 0.22920328203431858394 -0.021096041147255120696 -0.35772466511312367432 0.0014387133081624359915 -0.026024599329348044319 0.10156055834594888976 -0.041323579275150089385 -0.0091545934070838951707 -0.28227347488304371792 0.42068557369831832693 -0.043938939285399630785 0.11862521444384478697 0.0051183602132124830092 0.24488973813859737927 -0.1336093588815604194 -0.131579675963000714 -0.35975740473842632294 -0.3253887786892343259 -0.051412591975044191761 0.26222482136611952042 -0.41181393319048809065 -0.38968136414546661328 -0.11884391089800207253 0.18150307175174246188 -0.24119970068384227746 -0.52398544223286380728;-0.34808262733097122821 0.019024134814246113079 -0.10561215678145163821 0.2084632609143039772 -0.36520662557178423802 0.24712061065641355295 0.19184391562145478027 0.16857960514032416244 -0.18879537927576620082 -0.054879731214823680718 -0.010492848608247276262 -0.17141270797070110032 -0.32309003307638012314 -0.31705752826726157911 0.34565515322494044792 -0.28395720507436444935 -0.097142714917151512521 -0.012590104506762908945 -0.10044812729526723938 -0.23915973173910898275 0.26007263591015689075 0.13850202861684982047 -0.29681772648082899169 -0.08650828262425652726 -0.12911288250505920105 -0.39703602823015549106 -0.44840168243627048783 -0.23800857192778090976 0.12642743066435957466 0.05263935533728410221 -0.3670011588511752354 0.3189057457954614927 -0.090071070433701300173 0.17469732266069221138 0.208038177102081695 -0.15117875805897429409 0.1974089716784724613 0.24991045248946425206 0.07589766009834517102 -0.056341448884440897826 0.45165853184926146868 -0.027604313038789286133 0.26062198010248205371 -0.088884297849076435161;-0.34552584484925757957 0.11731274131870328414 -0.082261129330242738211 -0.37921603350449661907 -0.52927415276242373299 0.34172310615518580734 0.065025762796221325823 -0.025511366715062291227 0.11951903209220127167 -0.37526428124964833488 0.022231084639119606111 -0.29628986625269343458 -0.27997567201273326765 -0.33342591964284451489 0.12211495997249748047 0.20089625760367627039 0.17128921514832415318 0.072458594915874197095 -0.32311384849845220524 -0.058194484555012478133 -0.33326930566515267085 -0.3562525080459050808 -0.14955033234927134211 -0.27387992650586001631 0.082534213116642371477 0.27679605316612465593 -0.076844779194811210776 0.26896716628191796872 0.035324616886312623643 0.14691546487996837156 0.19862830897634475846 -0.039860790200463236399 0.41768644834640134 0.18266279682331193479 0.34120980418841867499 0.20338759801110756209 0.3457856448715302955 0.34886234612938787913 0.31922159348627709985 -0.26878123812911147716 0.12496187055767969676 0.048428961973607652369 -0.02003784765909092519 -0.040908582339492058355;-0.074543831759770889933 0.075013921934923274981 0.028522701022723993824 0.23240046219880369782 0.1104912307493813306 0.064714395248704675856 0.18037331045596541323 0.3339831182286371325 0.0062477005027109164259 -0.21613423899931127892 -0.33137854537325017734 -0.049224105278374459538 -0.46992715771070814323 -0.34016090972639467793 0.06663564218004766615 0.35607487402293908074 -0.23337831925184049364 0.24104358996490357625 -0.1723500053603601867 0.30361584248859285751 -0.20356956667797265759 0.28835345298772158129 -0.4060654315685117699 0.22132347623709242024 -0.069722552489580022494 0.10352141299096591365 -0.22774725151909680498 -0.2063308047843893378 0.033196855794773674764 -0.22023947284807579572 0.42060601951663029174 -0.20923040176391943801 0.36253678609112272024 -0.063733638930012603829 -0.10172852444071446565 0.19788055782820790363 -0.34322093629302691253 -0.35067235804910767971 -0.17347657012011238886 -0.02745773923733277333 0.086142797354713002145 0.25722436242129070871 0.020718071755106995391 -0.16806835363531830163;-0.2947742068817469363 -0.146767947402853427 -0.27513995706848765055 0.28108846481213450863 0.15325317709639446617 -0.26459848577907763012 -0.14437148874949276567 0.043447950830173429071 -0.41348421298272020064 0.10352069144092650166 0.28324159730308001715 -0.21259313561140485982 -0.3871915422816426533 -0.18723393820273348531 -0.21630773702708194772 -0.28505743956214518731 -0.0080635822426915436389 0.19433640047927763783 -0.0509539380223777566 0.27724794102248428995 0.089406187511579582328 0.22756442983618840881 0.34847397464019042035 -0.13356736072521865899 0.30578263617475276437 -0.19933716924152833361 0.15317480116070869567 -0.014794443342935059693 -0.31375341827864167144 -0.22255285984359984841 -0.34306592911798050594 -0.049860421869659353467 0.26025956730863042399 -0.089926794478070976036 0.068673031457234773312 -0.015161547222299506105 -0.30699784916286626535 -0.3535648470848757885 -0.45161159575448339698 -0.12855893862974682174 -0.064336275523838207246 -0.17535098452421843396 -0.053073566247954423458 -0.30129726378694859923;0.40430975505555422078 -0.20742276899958644876 -0.2049179093859421763 -0.28315362095011614718 0.10615878728683093846 0.16492287619126067 0.1119000931598738563 -0.28346355699707620479 0.24810764454229519704 -0.11614498021597632893 -0.10529887836233953191 0.12830141549002258006 0.028475440614836557834 -0.22758152369452519515 -0.21052022702303579971 -0.15087151104128768142 -0.27550854219905851483 -0.28140357378008395983 -0.27534474829775812399 0.07090889611720804786 0.21582120046677133463 -0.31824753161141067226 0.089134518724311162519 -0.37247951607856255585 0.091695489234514121479 0.33150520453061893544 -0.13077204714261347895 -0.32200653627157466152 0.33350584216832734885 -0.0043150453527412910293 0.23484675281281569559 -0.2899108317232266252 0.32771473097314984813 0.17593842765918538129 -0.13558899450421266208 -0.32912161251226118575 0.22781140589168516475 -0.25738656210651167378 -0.092244091324803351162 0.33847392567631318094 -0.016293271574204015728 0.054947141308104796575 0.32593386481295449908 0.1903564400851801286;-0.083916416217790709697 0.0848238884205937127 0.035914744159068714979 0.030857615385751189369 0.41322766596821519647 -0.25026060816000728071 0.46745407370113384316 -0.24853177569185108675 -0.33173461077361893201 0.010513969669473849367 -0.12503549326854435098 0.069107269438966334452 0.029963342284730878212 -0.27381814530564779764 -0.31229378509319055679 -0.062275168088122938304 0.38238520031975609115 0.23793365583355532977 0.022868917519505468916 -0.10684951765433797766 0.30140587763370157992 0.29491171814609806745 0.34810566038514240139 0.12862637191646919543 0.26956105508786820657 -0.19895006610425969296 0.3264104424932463 0.17467390652163994336 0.19620620138315347791 -0.11956188962910166418 -0.14246876733966412631 -0.2780353424731331069 0.1355589666155359585 0.11182009791270663968 0.46714318224500206433 0.33241798787161247475 -0.043992618028360186422 0.030824363107587682276 -0.2847070280259831887 0.1792508193234525482 0.35745158073410532307 0.34011274171335709182 -0.20067984017028023258 0.17982244794290686007;-0.21933700785492904473 0.44070605259884720883 0.24028932995504850845 0.068019738134038346122 0.10159712008688182028 -0.30458655431084852294 0.26416742706180346145 0.21302064806679127384 -0.17375407996847963554 0.33692876387457643128 0.22777583857353772556 -0.25254084630857642768 0.29230424503315244333 -0.15398920901078946843 0.28811881521345883428 -0.39220310967772953337 0.25597178452437341356 -0.14192711901703650157 0.062530243130695564724 0.064989210472175720779 0.058956511288235383117 -0.23368610814282780863 -0.24562286954188228272 0.1620871011379775295 -0.02149026636056124151 0.12413551526403773795 0.12388561094712396971 -0.27327383603844462856 0.28240189347637478789 0.26023587692676292127 0.061236107237221205912 -0.5842294916690551343 -0.23831193419356772045 0.2959260534701145251 0.045254947031707945526 0.32304304542436607095 0.13339681320612917226 -0.30510334998142213392 0.026458236024068521042 -0.014171869452131780065 -0.29664943719197733873 0.041625546568836581385 0.25129825600645439021 -0.019517919471156948419;-0.42125080550998705853 -0.14598048208691927208 -0.33196683059948522976 0.052728008939683206069 -0.32479591606652002955 0.082106466260830429649 -0.26638974340643339911 -0.1962421261572379616 -0.23929252450003063446 -0.0047961441965769279275 0.089804770946181458613 -0.34793561085110308317 -0.23644896670302939512 -0.21626771886572401793 0.22849839507657507265 0.22234664603351067536 0.083321703256273346727 0.10624712326527860351 0.40428123985194464041 -0.028157953545901490133 -0.080844389029675167713 0.28309354632531091855 0.14796021647258228437 -0.10849826187039041114 -0.090227883003005049378 -0.17963290387432401252 -0.048366434861686902202 -0.53041728478902583355 0.070069256290588188829 0.39420545120304995024 0.36462906703369490913 0.20396405255432556447 0.13529695156901141995 0.13751090873409901882 0.042244991208136836724 0.32763181786044121013 -0.33135383217746949835 0.31779532137015897852 0.30324501103374290611 0.38207100710327651649 0.30414766799308617928 -0.058146675889273573279 0.26786234699496225264 0.53807289383600587218;-0.18301065582245434893 -0.36807132072498771613 0.45107661218677302939 0.17602051709673322 -0.44497735248596609337 -0.097221007588090560536 -0.024740989672244639852 -0.20984614553202057818 -0.10392629813585774201 -0.040226276494082308099 -0.04113330228513051301 0.31150538453215270707 -0.24398798179112721196 -0.26276895221770135702 -0.032077724658481930609 0.013700658191737415115 0.24229021208844650492 -0.091909435239603654022 0.21812014076958805009 -0.31993785943628710866 0.32027593947128163432 -0.078364002818535172246 0.41710301292817192342 0.19158885053982666058 0.36318638330119623614 0.048569499311672287289 -0.13565667279980914151 0.27214725661005101376 0.06585491990995973044 -0.22752467978721174768 0.052300466324318964362 0.44152795214919754452 -0.023420834515907405088 -0.10584326643226266151 -0.42078167898387952572 -0.35876895790048662915 -0.083790943643327356338 -0.30664007887898137028 0.16562441937818495052 -0.087230959382538414415 0.05061656159021323681 -0.020466294054141818959 0.40805311084767642571 -0.47102128337810783565];

% Layer 2
b2 = 0.081960663327377336618;
LW2_1 = [-0.52968675896448291773 -0.29197614159498841424 -0.50304882669643691262 0.48193775317470799457 0.79917967372550424709 -0.5361005612871307946 0.56622286460213555603 -0.6533591061311945225 0.78712465536318798609 -0.68018357877596147265];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 3.5223825566451;
y1_step1.xoffset = 0.4352200589481;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
    X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},1); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS
    
    % Input 1
    X{1,ts} = X{1,ts}';
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = repmat(b2,1,Q) + LW2_1*a1;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a2,y1_step1);
    Y{1,ts} = Y{1,ts}';
end

% Final Delay States
Xf = cell(1,0);
Af = cell(2,0);

% Format Output Arguments
if ~isCellX
    Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
y = bsxfun(@minus,x,settings.xoffset);
y = bsxfun(@times,y,settings.gain);
y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
x = bsxfun(@minus,y,settings.ymin);
x = bsxfun(@rdivide,x,settings.gain);
x = bsxfun(@plus,x,settings.xoffset);
end
